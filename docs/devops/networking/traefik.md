---
title: Traefik
description: Обзор Traefik, современного reverse proxy и балансировщика нагрузки.
---

# Traefik: Современный Reverse Proxy

!!! abstract "Тезис"
    **Traefik** — это современный reverse proxy и балансировщик нагрузки с открытым исходным кодом, созданный специально для облачных окружений. Его ключевая особенность — **автоматическое обнаружение сервисов** и динамическое обновление конфигурации без необходимости перезапуска.

---

## Ключевые возможности

-   **Автоматическое Service Discovery**: Traefik интегрируется с Docker, Kubernetes, Consul и другими системами для автоматического обнаружения бэкендов и обновления своей конфигурации.
-   **Динамическая конфигурация**: Все изменения применяются на лету, без перезапуска.
-   **Поддержка HTTPS "из коробки"**: Автоматическая генерация и обновление TLS-сертификатов с помощью Let's Encrypt.
-   **Middleware**: Поддержка промежуточных обработчиков (middleware) для добавления аутентификации, сжатия, ограничения скорости и т.д.
-   **Веб-интерфейс**: Наглядный дашборд для просмотра текущей конфигурации и состояния.

---

## Архитектура

Traefik работает на основе концепций **Routers**, **Services** и **Middlewares**.

!!! example "Схема работы Traefik"
    ```plaintext
    +--------------+   (Request)   +------------------------------------+
    |   Client     | -----------> |              Traefik               |
    +--------------+              | +----------+  +-----------+  +-----+ |
                                  | | Entry-   |->|  Router   |->| Mid-| |
                                  | | point    |  | (e.g.     |  | dle-| |
                                  | | (e.g. :443)|  Host(`a.com`))|  | ware| |
                                  | +----------+  +-----------+  +--+--+ |
                                  |                              |     |
                                  | +----------+ <---------------+     |
                                  | | Service  |                       |
                                  | | (points to backend)            |
                                  | +----------+                       |
                                  +------------------------------------+
    ```

-   **EntryPoints**: Определяют порты, на которых Traefik принимает трафик (например, `:80` для HTTP, `:443` для HTTPS).
-   **Routers**: Анализируют входящие запросы (например, по хосту, пути, заголовкам) и направляют их на соответствующие сервисы.
-   **Services**: Определяют, как достичь бэкенд-приложений (например, указывают на Docker-контейнер или Kubernetes-сервис).
-   **Middlewares**: Могут изменять запрос или ответ (например, добавлять заголовки, выполнять аутентификацию).

---

## Пример конфигурации (для Docker)

!!! example "Пример в `docker-compose.yml`"
    ```yaml
    version: "3.3"

    services:
      traefik:
        image: "traefik:v2.5"
        command:
          - "--api.insecure=true"
          - "--providers.docker=true"
        ports:
          - "80:80"
          - "8080:8080"
        volumes:
          - "/var/run/docker.sock:/var/run/docker.sock"

      whoami:
        image: "traefik/whoami"
        labels:
          - "traefik.http.routers.whoami.rule=Host(`whoami.docker.localhost`)"
    ```
    В этом примере Traefik автоматически обнаружит контейнер `whoami` и создаст роутер, который будет направлять трафик с хоста `whoami.docker.localhost` на этот контейнер.

---

## Traefik vs Nginx

-   **Traefik** создан для динамических, облачных окружений. Его главное преимущество — автоматизация.
-   **Nginx** — это универсальный, проверенный временем веб-сервер и reverse proxy. Он чрезвычайно производителен и гибок, но требует ручной или полуавтоматической конфигурации (например, с помощью `nginx-reload` или `docker-gen`).

!!! success "Рекомендация"
    -   Используйте **Traefik**, когда вам нужна максимальная автоматизация и простота в динамических окружениях (Docker, Kubernetes).
    -   Используйте **Nginx**, когда требуется максимальная производительность, гибкость и контроль над конфигурацией.
