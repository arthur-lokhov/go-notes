---
title: Authelia
description: Обзор Authelia, легковесного прокси для аутентификации и авторизации.
---

# Authelia: Легковесный прокси для аутентификации

!!! abstract "Тезис"
    **Authelia** — это прокси для аутентификации и авторизации с открытым исходным кодом, который обеспечивает двухфакторную аутентификацию (2FA) и Single Sign-On (SSO) для ваших веб-приложений. Он работает в связке с reverse proxy, такими как Nginx, Traefik или HAProxy, перехватывая запросы и проверяя, аутентифицирован ли пользователь.

---

## Ключевые возможности

-   **Простота и легковесность**: Сфокусирован на одной задаче — защите приложений с помощью аутентификации.
-   **Двухфакторная аутентификация**: Поддержка Time-based One-Time Password (TOTP) и WebAuthn (FIDO2).
-   **Single Sign-On**: После входа пользователь получает доступ ко всем защищенным приложениям.
-   **Политики доступа**: Возможность определять правила доступа на основе домена, группы, IP-адреса и т.д.
-   **Интеграция с reverse proxy**: Легко интегрируется с популярными reverse proxy.

---

## Архитектура

Authelia работает как отдельный сервис, на который reverse proxy перенаправляет запросы для проверки аутентификации.

!!! example "Схема работы Authelia с Nginx"
    ```plaintext
    +----------+   (1. Request)    +-----------------+   (2. Forward Auth)   +-----------------+
    |  User    | ---------------> |      Nginx      | --------------------> |     Authelia    |
    +----------+                  +-------+---------+                     +-------+---------+
          ^                             |                                     |
          | (5. Allow/Deny)             | (4. 200 OK / 401 Unauthorized)      | (3. Check session)
          |                             v                                     |
    +-----|----+                  +-------+---------+                     +-------+---------+
    |     v    |                  |   Application   |                     | Login Portal    |
    |  Access  |                  +-----------------+                     +-----------------+
    +----------+
    ```

1.  Пользователь запрашивает доступ к защищенному приложению.
2.  Nginx (с помощью `ngx_http_auth_request_module`) отправляет подзапрос в Authelia для проверки.
3.  Authelia проверяет сессию пользователя. Если сессии нет, она перенаправляет пользователя на свой портал для входа.
4.  Authelia возвращает Nginx ответ `200 OK` (если доступ разрешен) или `401 Unauthorized` (если нет).
5.  Nginx либо проксирует запрос к приложению, либо возвращает ошибку пользователю.

---

## Authelia vs. Keycloak/Authentik

-   **Authelia** — это легковесный **прокси аутентификации**. Он не является полноценным провайдером идентификации (IdP), как Keycloak или Authentik. Его основная задача — защитить существующие приложения.
-   **Keycloak** и **Authentik** — это полнофункциональные **провайдеры идентификации**. Они могут управлять пользователями, предоставлять SSO для приложений, поддерживающих OIDC/SAML, и многое другое.

!!! success "Рекомендация"
    -   Используйте **Authelia**, если вам нужно быстро и просто добавить 2FA и SSO к вашим веб-приложениям, особенно если вы управляете ими через reverse proxy.
    -   Используйте **Keycloak** или **Authentik**, если вам нужно централизованное решение для управления идентификацией в масштабах всей компании.
