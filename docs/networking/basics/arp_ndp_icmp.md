---
title: ARP, NDP –∏ ICMP
---

# üì° ARP, NDP –∏ ICMP

–≠—Ç–∏ —Ç—Ä–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –∏–≥—Ä–∞—é—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å –Ω–∞ –∫–∞–Ω–∞–ª—å–Ω–æ–º (L2) –∏ —Å–µ—Ç–µ–≤–æ–º (L3) —É—Ä–æ–≤–Ω—è—Ö, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Å–≤—è–∑—å –≤ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É.

!!! info "–†–æ–ª–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤"
    - **ARP (Address Resolution Protocol)**: –°–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç IP-–∞–¥—Ä–µ—Å–∞ (L3) —Å MAC-–∞–¥—Ä–µ—Å–∞–º–∏ (L2) –≤ —Å–µ—Ç—è—Ö **IPv4**.
    - **NDP (Neighbor Discovery Protocol)**: –í—ã–ø–æ–ª–Ω—è–µ—Ç —Ç–µ –∂–µ —Ñ—É–Ω–∫—Ü–∏–∏, —á—Ç–æ –∏ ARP, –Ω–æ –¥–ª—è **IPv6**, –∞ —Ç–∞–∫–∂–µ —Ä–µ—à–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤ –∏ –∞–≤—Ç–æ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–¥—Ä–µ—Å–æ–≤.
    - **ICMP (Internet Control Message Protocol)**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ IP-—Å–µ—Ç—è—Ö (–¥–ª—è IPv4 –∏ IPv6).

---

##  ARP (Address Resolution Protocol)

!!! info "ARP —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –æ–¥–Ω–æ–≥–æ —à–∏—Ä–æ–∫–æ–≤–µ—â–∞—Ç–µ–ª—å–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞ (L2-—Å–µ–≥–º–µ–Ω—Ç–∞), –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –æ–¥–Ω–æ–π VLAN –∏–ª–∏ –∑–∞ –æ–¥–Ω–∏–º —Å–≤–∏—Ç—á–µ–º."

### ‚öôÔ∏è –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

1.  **ARP-–∑–∞–ø—Ä–æ—Å (Who has?)**: –ö–æ–≥–¥–∞ —Ö–æ—Å—Ç—É `A` (IP `192.168.1.10`) –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∞–∫–µ—Ç —Ö–æ—Å—Ç—É `B` (IP `192.168.1.20`), –Ω–æ MAC-–∞–¥—Ä–µ—Å —Ö–æ—Å—Ç–∞ `B` –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω, —Ö–æ—Å—Ç `A` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç **—à–∏—Ä–æ–∫–æ–≤–µ—â–∞—Ç–µ–ª—å–Ω—ã–π (broadcast)** ARP-–∑–∞–ø—Ä–æ—Å –Ω–∞ MAC-–∞–¥—Ä–µ—Å `FF:FF:FF:FF:FF:FF`.
    - –ó–∞–ø—Ä–æ—Å —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–æ–ø—Ä–æ—Å: "–£ –∫–æ–≥–æ IP-–∞–¥—Ä–µ—Å `192.168.1.20`? –°–æ–æ–±—â–∏—Ç–µ —Å–≤–æ–π MAC-–∞–¥—Ä–µ—Å –Ω–∞ –º–æ–π MAC `AA:AA:AA:AA:AA:AA`".

2.  **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞**: –í—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ –ø–æ–ª—É—á–∞—é—Ç —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å. –¢–µ, —É –∫–æ–≥–æ IP-–∞–¥—Ä–µ—Å –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç, –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç –µ–≥–æ.

3.  **ARP-–æ—Ç–≤–µ—Ç (I have)**: –•–æ—Å—Ç `B` –≤–∏–¥–∏—Ç, —á—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç –µ–≥–æ IP-–∞–¥—Ä–µ—Å, –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç **–æ–¥–Ω–æ–∞–¥—Ä–µ—Å–Ω—ã–π (unicast)** ARP-–æ—Ç–≤–µ—Ç –Ω–∞–ø—Ä—è–º—É—é —Ö–æ—Å—Ç—É `A`.
    - –û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç: "IP-–∞–¥—Ä–µ—Å `192.168.1.20` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —É –º–µ–Ω—è, –º–æ–π MAC-–∞–¥—Ä–µ—Å `BB:BB:BB:BB:BB:BB`".

4.  **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –•–æ—Å—Ç `A` –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ `192.168.1.20` -> `BB:BB:BB:BB:BB:BB` –≤ —Å–≤–æ—é **ARP-—Ç–∞–±–ª–∏—Ü—É (ARP-–∫—ç—à)** –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç.

### üß∞ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ARP-–∫—ç—à–µ–º

| –ö–æ–º–∞–Ω–¥–∞        | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                       |
| -------------- | ------------------------------------------------ |
| `arp -a`       | –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â—É—é ARP-—Ç–∞–±–ª–∏—Ü—É.                    |
| `arp -d <ip>`  | –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å –∏–∑ ARP-—Ç–∞–±–ª–∏—Ü—ã.                   |
| `arp -s <ip> <mac>` | –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é –∑–∞–ø–∏—Å—å –≤ ARP-—Ç–∞–±–ª–∏—Ü—É.       |

!!! example "–ü—Ä–æ—Å–º–æ—Ç—Ä ARP-—Ç–∞–±–ª–∏—Ü—ã –≤ Linux"
    ```bash
    ip neigh show
    # –∏–ª–∏
    arp -n
    ```
    –í—ã–≤–æ–¥ –ø–æ–∫–∞–∂–µ—Ç IP-–∞–¥—Ä–µ—Å–∞, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–º MAC-–∞–¥—Ä–µ—Å–∞ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–ø–∏—Å–∏ (`REACHABLE`, `STALE`).

---

## NDP (Neighbor Discovery Protocol)

!!! info "NDP ‚Äî —ç—Ç–æ –Ω–∞–±–æ—Ä –∏–∑ –ø—è—Ç–∏ ICMPv6-—Å–æ–æ–±—â–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–º–µ–Ω—è–µ—Ç –∏ —Ä–∞—Å—à–∏—Ä—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ARP –≤ —Å–µ—Ç—è—Ö IPv6."

### üöÄ –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

-   **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–æ—Å–µ–¥–µ–π (Neighbor Solicitation/Advertisement)**: –ê–Ω–∞–ª–æ–≥ ARP-–∑–∞–ø—Ä–æ—Å–∞/–æ—Ç–≤–µ—Ç–∞. –í–º–µ—Å—Ç–æ broadcast –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **multicast** –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π solicited-node multicast-–∞–¥—Ä–µ—Å, —á—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Å–µ—Ç—å.
-   **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤ (Router Solicitation/Advertisement)**: –•–æ—Å—Ç—ã –º–æ–≥—É—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞—Ö –≤ —Å–µ—Ç–∏, –∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä—ã –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –∞–Ω–æ–Ω—Å–∏—Ä—É—é—Ç —Å–≤–æ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ.
-   **–ê–≤—Ç–æ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–¥—Ä–µ—Å–æ–≤ (SLAAC)**: –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –º–æ–≥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ–±–µ IPv6-–∞–¥—Ä–µ—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ—Ñ–∏–∫—Å–∞ —Å–µ—Ç–∏, –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –æ—Ç –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞.
-   **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∞–¥—Ä–µ—Å–æ–≤ (DAD)**: –ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ IPv6-–∞–¥—Ä–µ—Å–∞ —Ö–æ—Å—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —ç—Ç–æ—Ç –∞–¥—Ä–µ—Å –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–µ–º-—Ç–æ –µ—â–µ.
-   **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–æ—Å–µ–¥–∞ (NUD)**: –ú–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ —Å–æ—Å–µ–¥ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –ø–æ –∏–∑–≤–µ—Å—Ç–Ω–æ–º—É MAC-–∞–¥—Ä–µ—Å—É.

!!! note "–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ"
    NDP –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –∏ –±–µ–∑–æ–ø–∞—Å–µ–Ω, —á–µ–º ARP, –±–ª–∞–≥–æ–¥–∞—Ä—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é multicast –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, SEND - Secure Neighbor Discovery).

---

## ICMP (Internet Control Message Protocol)

!!! info "ICMP ‚Äî —ç—Ç–æ —Å–ª—É–∂–µ–±–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∞ —Å–æ–æ–±—â–∞–µ—Ç –æ–± –æ—à–∏–±–∫–∞—Ö –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–µ—Ç–∏."

### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π

| –¢–∏–ø (Type) | –ö–æ–¥ (Code) | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                                                 | –ü—Ä–∏–º–µ—Ä —É—Ç–∏–ª–∏—Ç—ã |
|------------|------------|----------------------------------------------------------------------------|----------------|
| 0          | 0          | **Echo Reply** (–æ—Ç–≤–µ—Ç –Ω–∞ –ø–∏–Ω–≥)                                             | `ping`         |
| 3          | 0-15       | **Destination Unreachable** (—Å–µ—Ç—å/—Ö–æ—Å—Ç/–ø–æ—Ä—Ç/–ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)         | `ping`, `traceroute` |
| 5          | 0-3        | **Redirect** (—Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞ –æ–± –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–º –ø—É—Ç–∏)             | -              |
| 8          | 0          | **Echo Request** (–∑–∞–ø—Ä–æ—Å –ø–∏–Ω–≥–∞)                                            | `ping`         |
| 11         | 0-1        | **Time Exceeded** (–≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –ø–∞–∫–µ—Ç–∞ (TTL) –∏—Å—Ç–µ–∫–ª–æ)                       | `traceroute`   |

### üõ†Ô∏è –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

-   **`ping`**: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç ICMP Echo Request (Type 8) –∏ –æ–∂–∏–¥–∞–µ—Ç ICMP Echo Reply (Type 0). –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ö–æ—Å—Ç–∞.
-   **`traceroute` / `tracert`**: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∞–∫–µ—Ç—ã —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–º—Å—è TTL. –ö–æ–≥–¥–∞ TTL –¥–æ—Å—Ç–∏–≥–∞–µ—Ç 0, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ ICMP Time Exceeded (Type 11), –ø–æ–∑–≤–æ–ª—è—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å IP-–∞–¥—Ä–µ—Å —ç—Ç–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞. –¢–∞–∫ —Å—Ç—Ä–æ–∏—Ç—Å—è –ø—É—Ç—å –¥–æ —Ü–µ–ª–∏.

!!! example "–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã `ping`"
    ```bash
    ping 8.8.8.8
    ```
    - –í–∞—à —Ö–æ—Å—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç ICMP-–ø–∞–∫–µ—Ç (Type 8) –Ω–∞ `8.8.8.8`.
    - –°–µ—Ä–≤–µ—Ä Google DNS –æ—Ç–≤–µ—á–∞–µ—Ç ICMP-–ø–∞–∫–µ—Ç–æ–º (Type 0).
    - –£—Ç–∏–ª–∏—Ç–∞ –∏–∑–º–µ—Ä—è–µ—Ç –≤—Ä–µ–º—è –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–æ–º –∏ –æ—Ç–≤–µ—Ç–æ–º (RTT).

!!! danger "–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω–æ–µ –º–µ—Å—Ç–æ"
    –ú–Ω–æ–≥–∏–µ —Å–µ—Ç–µ–≤—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –±–ª–æ–∫–∏—Ä—É—é—Ç ICMP-—Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ —Ñ–∞–π—Ä–≤–æ–ª–∞—Ö –∏–∑ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç `ping flood` DDoS-–∞—Ç–∞–∫). –û–¥–Ω–∞–∫–æ –ø–æ–ª–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ ICMP –º–æ–∂–µ—Ç –Ω–∞—Ä—É—à–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å–µ—Ç–∏, —Ç–∞–∫ –∫–∞–∫ –≤–∞–∂–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, Destination Unreachable) –Ω–µ –±—É–¥—É—Ç –¥–æ—Ö–æ–¥–∏—Ç—å –¥–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è.
