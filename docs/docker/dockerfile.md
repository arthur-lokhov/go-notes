# üì¶ Dockerfile –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤
<!--markdownlint-disable MD046-->

**Docker** ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è, —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∏ –∑–∞–ø—É—Å–∫–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö.
–í –æ—Å–Ω–æ–≤–µ –≤—Å–µ–≥–æ –ª–µ–∂–∞—Ç –æ–±—Ä–∞–∑—ã ‚Äî –æ–Ω–∏ —Å—Ç—Ä–æ—è—Ç—Å—è –∏–∑ **Dockerfile**, –∫–æ—Ç–æ—Ä—ã–π –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –∏—Ö —Å–±–æ—Ä–∫–∏.

---

## üîπ –ß—Ç–æ —Ç–∞–∫–æ–µ Dockerfile

**Dockerfile** ‚Äî —ç—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ Docker —á–∏—Ç–∞–µ—Ç –ø–æ–æ—á–µ—Ä–µ–¥–Ω–æ, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞–∑.

–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä:

```Dockerfile
FROM alpine:3.18
RUN apk add --no-cache curl
COPY . /app
WORKDIR /app
CMD ["./start.sh"]
```

---

## üîç –ö–æ–º–∞–Ω–¥—ã Dockerfile

| –ö–æ–º–∞–Ω–¥–∞      | –û–ø–∏—Å–∞–Ω–∏–µ                                                      |
| ------------ | ------------------------------------------------------------- |
| `FROM`       | –ë–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Å–±–æ—Ä–∫–∏                               |
| `RUN`        | –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–±–æ—Ä–∫–∏ (—Å–æ–∑–¥–∞–µ—Ç —Å–ª–æ–π)           |
| `COPY`       | –ö–æ–ø–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã/–ø–∞–ø–∫–∏ –≤ –æ–±—Ä–∞–∑                                  |
| `ADD`        | –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è `COPY`: —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ `.tar`, –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ URL |
| `WORKDIR`    | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é                              |
| `ENV`        | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è                            |
| `EXPOSE`     | –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–π –ø–æ—Ä—Ç (–Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç!)                   |
| `CMD`        | –ö–æ–º–∞–Ω–¥–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∑–∞–ø—É—Å–∫–∞                              |
| `ENTRYPOINT` | –ë–∞–∑–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞, –Ω–µ –∑–∞–º–µ–Ω—è–µ–º–∞—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ                    |
| `VOLUME`     | –û–±—ä—è–≤–ª—è–µ—Ç —Ç–æ—á–∫—É –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è volume                       |
| `ARG`        | –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∏, –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –∏—Ç–æ–≥–æ–≤–æ–º –æ–±—Ä–∞–∑–µ           |
| `LABEL`      | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–± –æ–±—Ä–∞–∑–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–≤—Ç–æ—Ä, –≤–µ—Ä—Å–∏—è)                |
| `USER`       | –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–æ–º–∞–Ω–¥—ã      |
| `ONBUILD`    | –ö–æ–º–∞–Ω–¥–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –≤ –æ–±—Ä–∞–∑–∞—Ö-–ø–æ—Ç–æ–º–∫–∞—Ö           |
| `MAINTAINER` | (–£—Å—Ç–∞—Ä–µ–ª–∞) –£–∫–∞–∑—ã–≤–∞–µ—Ç –∞–≤—Ç–æ—Ä–∞ –æ–±—Ä–∞–∑–∞                            |

### ‚öñÔ∏è CMD vs ENTRYPOINT

–ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞:

```bash
docker run myimage World
```

–ï—Å–ª–∏ `CMD`, —Ç–æ `echo Hello` –±—É–¥–µ—Ç –∑–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `World` –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —É–ø–∞–¥–µ—Ç —Å –æ—à–∏–±–∫–æ–π.

–ï—Å–ª–∏ `ENTRYPOINT`, —Ç–æ –±—É–¥–µ—Ç `echo World`, —Ç–∞–∫ –∫–∞–∫ –∫–æ–º–∞–Ω–¥—ã –Ω–µ–ª—å–∑—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å.

–ú–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –æ–±–∞ –ø–æ–¥—Ö–æ–¥–∞:

```Dockerfile
ENTRYPOINT ["echo"]
CMD ["Hello"]
```

–¢–æ –µ—Å—Ç—å –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç `echo`, –∞ –≤–æ—Ç —Ç–æ —á—Ç–æ –ø–æ—Å–ª–µ –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å.

---

## ‚öôÔ∏è 3. –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –æ–±—Ä–∞–∑–æ–≤

```bash
docker build -t myapp .
docker run myapp
```

---

## üìò –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–±—Ä–∞–∑–∞–º–∏

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã —Å–æ–±—Ä–∞–Ω—ã –º–Ω–æ—é –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ: [–ü–æ–¥—Ä–æ–±–Ω–µ–µ](./commands.md).

---

## üîÅ –ö–æ–Ω—Ç–µ–∫—Å—Ç —Å–±–æ—Ä–∫–∏

**–ö–æ–Ω—Ç–µ–∫—Å—Ç** ‚Äî —ç—Ç–æ –Ω–∞–±–æ—Ä —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –¥–µ–º–æ–Ω—É Docker –¥–ª—è —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞.

| –ò—Å—Ç–æ—á–Ω–∏–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ | –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `COPY/ADD` | –¢—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç | –ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å                   |
| ------------------ | ----------------------- | ---------------- | ------------------------------ |
| –õ–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–ø–∫–∞    | ‚úÖ                       | ‚ùå                | –ü–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞        |
| –ê—Ä—Ö–∏–≤              | ‚úÖ                       | ‚ùå                | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è, CI/CD           |
| Git-—Ä–µ–ø–æ           | ‚úÖ                       | ‚úÖ                | –°–±–æ—Ä–∫–∞ –∏–∑ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ |
| STDIN              | ‚ùå                       | ‚ùå                | –ë—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞ —Å `RUN`, `CMD`  |

### –õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–∞–ø–∫–∏

```bash
docker build -t myimage .
```

1. `.` ‚Äî —Ç–µ–∫—É—â–∞—è –ø–∞–ø–∫–∞ (–∫–æ—Ä–µ–Ω—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞).
2. **Docker** –±–µ—Ä–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã, –Ω–µ –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ .dockerignore, –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç –∏—Ö –Ω–∞ —Å–±–æ—Ä–∫—É.

!!! warning

    –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ `docker build /` ‚Äî —ç—Ç–æ –ø–µ—Ä–µ–¥–∞—Å—Ç –≤—Å—é —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É!

### .tar –∞—Ä—Ö–∏–≤—ã

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞—Ä–∞–Ω–µ–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:

```bash
docker build - < context.tar
```

–ò–ª–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º `-f` –¥–ª—è **Dockerfile** –≤–Ω—É—Ç—Ä–∏ –∞—Ä—Ö–∏–≤–∞:

```bash
docker build -f app/Dockerfile app.tar.gz
```

1. **Docker** —Ä–∞—Å–ø–∞–∫—É–µ—Ç –∞—Ä—Ö–∏–≤ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç —Å–±–æ—Ä–∫—É.
2. –£–¥–æ–±–Ω–æ –¥–ª—è CI/CD –ø–∞–π–ø–ª–∞–π–Ω–æ–≤, –µ—Å–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –Ω–∞–ø—Ä—è–º—É—é.

### Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

**Docker** –º–æ–∂–µ—Ç –Ω–∞–ø—Ä—è–º—É—é —Å–∫–∞—á–∞—Ç—å –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É):

```bash
docker build https://github.com/user/repo.git
docker build git@github.com:user/repo.git
docker build git://github.com/user/repo.git
```

1. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Dockerfile*8 –∏–∑ –∫–æ—Ä–Ω—è.
2. –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –∫ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥—É —Å `-f`:

```bash
docker build -f subfolder/Dockerfile https://github.com/user/repo.git
```

!!! warning

    –î–ª—è `git@` –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è SSH-–∫–ª—é—á –≤ –∞–≥–µ–Ω—Ç–µ (ssh-agent).

### –í—Ö–æ–¥–Ω–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ STDIN

–ò–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å **Dockerfile** –Ω–∞–ø—Ä—è–º—É—é, –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Å–±–æ—Ä–∫–∏ "–Ω–∞ –ª–µ—Ç—É":

```bash
docker build - < Dockerfile
```

–ó–¥–µ—Å—å:

- –§–∞–π–ª **Dockerfile** –ø–æ–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ **stdin**.
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–µ—Ç ‚Äî –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `COPY`, `ADD`, —Ç.–∫. –Ω–µ—Ç —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
- –ü–æ–¥—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—Ä–∞–∑–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –Ω—É–∂–¥–∞—é—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–∞—Ö

---

## üìÑ .dockerignore

–ê–Ω–∞–ª–æ–≥ `.gitignore` ‚Äî –∏—Å–∫–ª—é—á–∞–µ—Ç —Ñ–∞–π–ª—ã –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:

```.dockerignore
node_modules
*.log
.env
.git
```

> –£–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ —É—Å–∫–æ—Ä—è–µ—Ç —Å–±–æ—Ä–∫—É.

---

## üß± –°–ª–æ–∏ –≤ Docker

### –ß—Ç–æ —Ç–∞–∫–æ–µ —Å–ª–æ–π

**–°–ª–æ–π (layer)** ‚Äî —ç—Ç–æ –æ–¥–∏–Ω –∏–∑ —Å–ª–æ—ë–≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –æ–±—Ä–∞–∑–∞ **Docker**, —Ñ–æ—Ä–º–∏—Ä—É–µ–º—ã–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–∑ **Dockerfile**.

–ö–∞–∂–¥–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `FROM`, `COPY`, `ADD`, `RUN` –∏ –¥—Ä—É–≥–∏–µ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π —Å–ª–æ–π, –∫–æ—Ç–æ—Ä—ã–π:

- –ù–µ–∏–∑–º–µ–Ω—è–µ–º –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è.
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –ø—Ä–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–∏.
- –Ø–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é –Ω–∞—Å–ª–µ–¥—É–µ–º–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã: —Å–ª–µ–¥—É—é—â–∏–π —Å–ª–æ–π –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π.

–ü—Ä–∏–º–µ—Ä:

```Dockerfile
FROM alpine           # –°–ª–æ–π 1: –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑
COPY . /app           # –°–ª–æ–π 2: –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
RUN apk add curl      # –°–ª–æ–π 3: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ curl
CMD ["./start.sh"]    # –°–ª–æ–π 4: –∫–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞
```

> –í–∏–∑—É–∞–ª—å–Ω–æ –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –ø–∏—Ä–æ–≥ –∏–∑ —Å–ª–æ—ë–≤, –≥–¥–µ –∫–∞–∂–¥—ã–π —Å–ª–æ–π ‚Äî —ç—Ç–æ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É.

### –ö–∞–∫ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–ª–æ–∏

1. –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ **Dockerfile** –∫–∞–∂–¥–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (`RUN`, `COPY`, `ADD`, `ENV`, `LABEL` –∏ —Ç.–¥.) —Å–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–ª–æ–π.
2. **Docker** —Å–æ–∑–¥–∞–µ—Ç **–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä** –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–ª–æ—è, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∫ –Ω–æ–≤—ã–π —Å–ª–æ–π –∏ —É–¥–∞–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.

### –ß—Ç–æ —Ç–∞–∫–æ–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

**–í—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä** ‚Äî —ç—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω–∞—è —Å—Ä–µ–¥–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–µ–∫—É—â–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `RUN`, `COPY`, `ADD`.

1. –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —É–¥–∞–ª—è–µ—Ç—Å—è (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ `--rm=false`).
2. –ï—Å–ª–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–∞–¥–∞–µ—Ç ‚Äî –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ—Å—Ç–∞—ë—Ç—Å—è, –∏ –µ–≥–æ –º–æ–∂–Ω–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å.

–ü—Ä–∏–º–µ—Ä:

```bash
docker build --rm=false . # –ï—Å–ª–∏ —Å–±–æ—Ä–∫–∞ —É–ø–∞–¥–µ—Ç, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è.
```

### –ö–∞–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –ø–æ—Å–ª–µ —Å–±–æ—è

```bash
docker ps -a # –ù–∞–π—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker commit <container_id> debug_image # –°–æ–∑–¥–∞—Ç—å –∏–∑ –Ω–µ–≥–æ –æ–±—Ä–∞–∑
docker run -it debug_image sh # –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ
```

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª–æ–π –≤—Ä—É—á–Ω—É—é

```bash
docker history <image_name> # –£–∑–Ω–∞—Ç—å ID —Å–ª–æ—è
docker run -it <layer_id> sh # –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω—É–∂–Ω—ã–π —Å–ª–æ–π
```

### –ü–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Ñ–æ–Ω–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∂–∏–≤–µ—Ç **—Ç–æ–ª—å–∫–æ –≤ –º–æ–º–µ–Ω—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏**.

```Dockerfile
RUN service mysql start  # –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ —Ñ–æ–Ω–µ
RUN echo ok              # –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Å–ª–æ–π –∑–∞–≤–µ—Ä—à–∏–ª—Å—è ‚Äî –ø—Ä–æ—Ü–µ—Å—Å MySQL –∏—Å—á–µ–∑
```

> –ö–∞–∂–¥—ã–π `RUN` ‚Äî –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ä–µ–¥–∞.

---

## üß† –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ—ë–≤

**Docker** –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à, –µ—Å–ª–∏:

- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∏–¥–µ–Ω—Ç–∏—á–Ω–∞.
- –ö–æ–Ω—Ç–µ–∫—Å—Ç (`COPY`, `ADD`) –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è.
- –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω `--no-cache`.

–û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫—ç—à–∞:

```bash
docker build --no-cache -t myapp .
```

| –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è  | –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏               |
| ----------- | ------------------------------------- |
| `COPY . .`  | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª—é–±–æ–≥–æ —Ñ–∞–π–ª–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∫—ç—à |
| `ADD <url>` | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞    |
| `RUN date`  | –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫—ç—à–∏—Ä—É–µ—Ç—Å—è                 |

---

## üß∞ Phusion BaseImage

Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ–±—ã—á–Ω–æ –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç `systemd` –∏–ª–∏ `init` ‚Äî —ç—Ç–æ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —Ç—Ä–µ–±—É—é—â–∏—Ö —Ñ–æ–Ω–æ–≤—É—é —Ä–∞–±–æ—Ç—É –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

Phusion –±—ã–ª —Å–æ–∑–¥–∞–Ω —Å —Ü–µ–ª—å—é —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É: [–ü–æ–¥—Ä–æ–±–Ω–µ–µ](https://github.com/phusion/baseimage-docker).
