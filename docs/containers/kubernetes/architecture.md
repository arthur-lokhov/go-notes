
# Архитектура Kubernetes

Kubernetes состоит из *control plane* и *data plane*.

**Control Plane** - управляющий контур, который запускается в пределах нод, называемых *master*,
и может запускаться как одиночном режиме(*single master*), так и в распределенном(*multi master*).

Control plane содержит:

- **ETCD** - хранилище конфигурации кластера
- **Kubernetes API** - предоставляет API, посредством которого взаимодействуют компоненты k8s,
а также клиенты находящиеся внутри и вне кластера.
- **Kubernetes Controller Manager** - реализует концепцию контроллеров, которые управляют базовыми сущностями кластеров.
- **Kubernetes scheduler** - выбирает ноды, на которых нужно запускать PODы.
- **Cloud controller manager** - используется для реализации функций работы с облаком.

**Data plane** - компоненты, которые запущены на каждой ноде.

- **kubelet** - следит за изменениями конфигурации ноды, применяет конфигурации, делает пробы контейнеров, отчитывается о статусе контейнеров, работает с CRI-плагином и реализует функции запуска и остановки контейнеров.
- **kube-proxy** - отвечает за сетевой компонент. Работает с CNI-плагином и обеспечивает функционрирование сущности *Service* в пределах своей ноды.

## Kube-proxy

**kube-proxy** - компонент *data plane*, который работает на каждой ноде.
Он взаимодействеут с CNI-плагином, обеспечивая функционирование *pod network*.
А также обеспечивает функционирование описанных в кластере сервисов в пределах своей ноды.
В зависимости от режима выступает либо в роли прокси, либо как контроллер правил IPTABLES/IPVS.

## CRI

CRI расшифровыется как **Container Runtime Interface**.
Это спецификация, описывающая некий уровень абстракции, который позволяет унифицированно использовать разные версии ПО для работы с контейнерами, например *containerd* или *CRI-O*.
