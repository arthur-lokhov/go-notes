---
title: Docker Compose
---

# üéº Docker Compose

!!! abstract "–ß—Ç–æ —Ç–∞–∫–æ–µ docker-compose.yml"

    **`docker-compose.yml`** ‚Äî —ç—Ç–æ YAML-—Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è **Docker Compose**, —É—Ç–∏–ª–∏—Ç—ã, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–π –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏ –∑–∞–ø—É—Å–∫–∞ –º–Ω–æ–≥–æ–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã—Ö Docker-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

    –í —ç—Ç–æ–º —Ñ–∞–π–ª–µ –≤—ã –æ–ø–∏—Å—ã–≤–∞–µ—Ç–µ –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (—Å–µ—Ä–≤–∏—Å—ã, —Å–µ—Ç–∏, —Ç–æ–º–∞) –∏ –∏—Ö –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ –≤ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ. Compose —á–∏—Ç–∞–µ—Ç —ç—Ç–æ—Ç —Ñ–∞–π–ª –∏ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π (`docker compose up`) —Å–æ–∑–¥–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å—é –≤–∞—à—É —Å—Ä–µ–¥—É.

    –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π Compose, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π *Compose Specification*, —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –¥–µ-—Ñ–∞–∫—Ç–æ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ —Ç–æ–ª—å–∫–æ Docker, –Ω–æ –∏ –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏.

---

## üèõÔ∏è `docker-compose.yml`

–§–∞–π–ª –∏–º–µ–µ—Ç —á–µ—Ç–∫—É—é –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É.

–ù–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∫–ª—é—á–∏, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤–∞—à–µ–≥–æ —Å—Ç–µ–∫–∞.

```yaml
# –í–µ—Ä—Å–∏—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è, –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ)
version: '3.9'

# –û—Å–Ω–æ–≤–Ω–æ–π —Ä–∞–∑–¥–µ–ª, –≥–¥–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (—Å–µ—Ä–≤–∏—Å—ã)
services:
  ...

# –†–∞–∑–¥–µ–ª –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–º–æ–≤ (volumes)
volumes:
  ...

# –†–∞–∑–¥–µ–ª –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–µ—Ç–µ–π
networks:
  ...

# –†–∞–∑–¥–µ–ª –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è Swarm)
configs:
  ...

# –†–∞–∑–¥–µ–ª –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–∞–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è Swarm)
secrets: 
  ...
```

!!! tip "YAML-—Å—Ö–µ–º–∞ –¥–ª—è IDE"

    –î–ª—è —É–ª—É—á—à–µ–Ω–∏—è –æ–ø—ã—Ç–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (DX) –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –≤–∞—à–µ–π IDE, –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é **JSON-—Å—Ö–µ–º—É** *Compose Specification*.

    **–ü—Ä–∏–º–µ—Ä –¥–ª—è VS Code (`.vscode/settings.json`):**

    ```json
    {
      "yaml.schemas": {
        "https://raw.githubusercontent.com/compose-spec/compose-spec/master/schema/compose-spec.json": "docker-compose*.yml"
      }
    }
    ```

!!! warning "–¢–æ–ª—å–∫–æ –¥–ª—è Docker Swarm"

    –†–∞–∑–¥–µ–ª—ã `configs` –∏ `secrets` –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ `docker-compose.yml` —Ä–∞–±–æ—Ç–∞—é—Ç **—Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ Docker Swarm**.

    –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Å –æ–±—ã—á–Ω—ã–º `docker compose` –æ–Ω–∏ –±—É–¥—É—Ç –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—à–∏–±–∫–∞–º –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

### ‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ—Ä–≤–∏—Å–æ–≤

–≠—Ç–æ —Å–µ—Ä–¥—Ü–µ `docker-compose.yml`.

–ö–∞–∂–¥—ã–π –∫–ª—é—á –≤ —Ä–∞–∑–¥–µ–ª–µ `services` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (—Å–µ—Ä–≤–∏—Å) –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

```yaml
services:
  web:
    # --- –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ---
    image: nginx:1.25-alpine  # –ò–º—è –∏ —Ç–µ–≥ Docker-–æ–±—Ä–∞–∑–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    build:  # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞ –∏–∑ Dockerfile
      context: ./web  # –ü—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å Dockerfile –∏ –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º
      dockerfile: Dockerfile  # –ò–º—è Dockerfile (–µ—Å–ª–∏ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ)
      args: { APP_ENV: production }  # –ê—Ä–≥—É–º–µ–Ω—Ç—ã, –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏
      target: builder  # –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Å—Ç–∞–¥–∏—è multi-stage —Å–±–æ—Ä–∫–∏
      ssh: default # –ü—Ä–æ–±—Ä–æ—Å SSH-–∫–ª—é—á–µ–π –∞–≥–µ–Ω—Ç–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º
      cache_from:  # –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–µ—à–∞ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏
        - type=registry,ref=my-registry/app:buildcache
        - type=local,src=./.build_cache
    container_name: my-nginx  # –ò–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤)
    hostname: webhost  # –ò–º—è —Ö–æ—Å—Ç–∞ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
    profiles: ["frontend"]  # –ü—Ä–æ—Ñ–∏–ª–∏, –ø–æ–∑–≤–æ–ª—è—é—â–∏–µ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤
    command: ["nginx", "-g", "daemon off;"]  # –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (CMD) –≤ –æ–±—Ä–∞–∑–µ
    entrypoint: ["/docker-entrypoint.sh"]  # –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞ (ENTRYPOINT) –≤ –æ–±—Ä–∞–∑–µ

    # --- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Ä–µ—Å—É—Ä—Å—ã ---
    read_only: true  # –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ —Ä–µ–∂–∏–º–µ "—Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è"
    cap_drop: [ALL]  # –û—Ç–∫–ª—é—á–∞–µ—Ç –≤—Å–µ capabilities —è–¥—Ä–∞ Linux –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    security_opt: [no-new-privileges:true]  # –ó–∞–ø—Ä–µ—â–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—É –ø–æ–ª—É—á–∞—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏
    user: "1001:1001"  # UID:GID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
    ulimits:  # –õ–∏–º–∏—Ç—ã –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
      nofile: { soft: 65536, hard: 65536 }  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤
    sysctls:  # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —è–¥—Ä–∞ (sysctl) –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
      net.core.somaxconn: 1024

    # --- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è ---
    environment:  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
      - NODE_ENV=production
      - "CACHE_SIZE=${CACHE_SIZE:-1024}" # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    env_file: ./.env  # –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ —Ñ–∞–π–ª–∞

    # --- –°–µ—Ç—å ---
    ports: ["80:80"]  # –ü—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –•–û–°–¢:–ö–û–ù–¢–ï–ô–ù–ï–†
    expose: ["8080"]  # –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ —Ç–æ–π –∂–µ —Å–µ—Ç–∏
    networks: [frontend]  # –ü–æ–¥–∫–ª—é—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫ —É–∫–∞–∑–∞–Ω–Ω—ã–º —Å–µ—Ç—è–º
    dns: [8.8.8.8]  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–µ DNS-—Å–µ—Ä–≤–µ—Ä—ã
    extra_hosts:  # –î–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ /etc/hosts –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
      - "my-db.local:192.168.1.100"
    network_mode: "host" # ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ç–µ–≤–æ–π —Å—Ç–µ–∫ —Ö–æ—Å—Ç–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è Linux)

    # --- –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ ---
    volumes: ["./code:/var/www/html", "db_data:/var/lib/postgresql/data"]  # –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–º–æ–≤ –∏ **bind mounts**
    tmpfs: /tmp  # –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –≤ RAM
    working_dir: /var/www/html  # –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

    # --- –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ ---
    restart: always  # –ü–æ–ª–∏—Ç–∏–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
    stop_grace_period: 30s # –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–µ—Ä–µ–¥ SIGKILL
    depends_on:  # –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
      db: { condition: service_healthy }  # –ñ–¥–µ—Ç, –ø–æ–∫–∞ —Å–µ—Ä–≤–∏—Å 'db' –Ω–µ —Å—Ç–∞–Ω–µ—Ç –∑–¥–æ—Ä–æ–≤—ã–º
    healthcheck:  # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞
      test: ["CMD", "curl", "-f", "http://localhost"]  # –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
      interval: 30s  # –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
      timeout: 10s  # –¢–∞–π–º–∞—É—Ç –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
      retries: 3  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ —Å—á–∏—Ç–∞—Ç—å —Å–µ—Ä–≤–∏—Å –Ω–µ–∑–¥–æ—Ä–æ–≤—ã–º
      start_period: 40s  # –í—Ä–µ–º—è –Ω–∞ –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–æ –Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–æ–∫
    
    # --- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ---
    init: true # –î–æ–±–∞–≤–ª—è–µ—Ç init-–ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
    stdin_open: true # –î–µ—Ä–∂–∞—Ç—å STDIN –æ—Ç–∫—Ä—ã—Ç—ã–º (—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç `docker run -i`)
    tty: true # –í—ã–¥–µ–ª–∏—Ç—å –ø—Å–µ–≤–¥–æ-TTY (—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç `docker run -t`)
    privileged: true # ‚ö†Ô∏è –î–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ö–æ—Å—Ç—É
    shm_size: "256m" # –†–∞–∑–º–µ—Ä —Ä–∞–∑–¥–µ–ª—è–µ–º–æ–π –ø–∞–º—è—Ç–∏ (/dev/shm)

    # --- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ---
    labels:  # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
      com.example.description: "Web service"
    logging:  # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
      driver: "json-file"  # –î—Ä–∞–π–≤–µ—Ä –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
      options:  # –û–ø—Ü–∏–∏ –¥—Ä–∞–π–≤–µ—Ä–∞
        max-size: "10m"

    # --- –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è Docker Swarm) ---
    deploy:  # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤ —Ä–µ–∂–∏–º–µ Swarm
      replicas: 3  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–ø–ª–∏–∫ —Å–µ—Ä–≤–∏—Å–∞
      resources:  # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ä–µ—Å—É—Ä—Å—ã
        limits: { cpus: "0.5", memory: 512M }
```

### üíæ –û–±—â–∏–µ —Ç–æ–º–∞

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–º–∞, –∫–æ—Ç–æ—Ä—ã–º–∏ –º–æ–≥—É—Ç —Å–æ–≤–º–µ—Å—Ç–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤. –≠—Ç–æ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

```yaml
volumes:
  db_data: # –ò–º—è —Ç–æ–º–∞, –∫–æ—Ç–æ—Ä–æ–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö
    driver: local # –î—Ä–∞–π–≤–µ—Ä —Ç–æ–º–∞ (local, nfs, –∏ —Ç.–¥.)
    driver_opts: # –û–ø—Ü–∏–∏ –¥–ª—è –¥—Ä–∞–π–≤–µ—Ä–∞
      type: none
      device: /home/user/data # –ü—É—Ç—å –Ω–∞ —Ö–æ—Å—Ç–µ –¥–ª—è bind mount
      o: bind
    labels: # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–æ–º–∞
      purpose: "Database persistent storage"
```

### üåê –°–µ—Ç–∏

–ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å–µ—Ç–∏ –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤. –°–µ—Ä–≤–∏—Å—ã –≤–∏–¥—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –ø–æ –∏–º–µ–Ω–∞–º —Ç–æ–ª—å–∫–æ –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏.

```yaml
networks:
  frontend:
    driver: bridge # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å–µ—Ç—å –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞
  backend:
    driver: overlay # –°–µ—Ç—å –¥–ª—è Docker Swarm, —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ö–æ—Å—Ç–∞—Ö
    attachable: true # –†–∞–∑—Ä–µ—à–∞–µ—Ç —Ä—É—á–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
    ipam: # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–∞—Ü–∏–µ–π
      driver: default
      config:
        - subnet: 172.16.238.0/24 # –ó–∞–¥–∞—Ç—å –ø–æ–¥—Å–µ—Ç—å
```

---

## üöÄ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### üèóÔ∏è –ù–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤

–î–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—Ä–æ–¥–∞–∫—à–Ω) –ø—Ä–∏–Ω—è—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ `docker-compose` —Ñ–∞–π–ª–æ–≤.

Docker Compose –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏—Ö –≤ –æ–¥–Ω—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é.

-   **`docker-compose.yml`**: –ë–∞–∑–æ–≤—ã–π —Ñ–∞–π–ª, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –æ–±—â–∏–µ –¥–ª—è –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π —Å–µ—Ä–≤–∏—Å—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
-   **`docker-compose.override.yml`**: –§–∞–π–ª –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.
**Compose –∑–∞–≥—Ä—É–∂–∞–µ—Ç –µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**, –µ—Å–ª–∏ –æ–Ω –ª–µ–∂–∏—Ç —Ä—è–¥–æ–º —Å –æ—Å–Ω–æ–≤–Ω—ã–º —Ñ–∞–π–ª–æ–º.
–í –Ω–µ–º –æ–±—ã—á–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç `command` –¥–ª—è **hot-reload**, –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—é—Ç –ø–æ—Ä—Ç—ã –∏ –º–æ–Ω—Ç–∏—Ä—É—é—Ç –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.
-   **`docker-compose.prod.yml` / `docker-compose.staging.yml`**: –§–∞–π–ª—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π.
–í –Ω–∏—Ö –∑–∞–¥–∞—é—Ç –ø–æ–ª–∏—Ç–∏–∫–∏ `restart`, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ç.–¥.

!!! example "–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞"

    ```
    project/
    ‚îú‚îÄ‚îÄ docker-compose.yml          # –ë–∞–∑–∞
    ‚îú‚îÄ‚îÄ docker-compose.override.yml # –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–∞–≤—Ç–æ-–ø–æ–¥–≥—Ä—É–∑–∫–∞)
    ‚îú‚îÄ‚îÄ docker-compose.prod.yml     # –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
    ‚îú‚îÄ‚îÄ .env                        # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
    ‚îú‚îÄ‚îÄ .env.prod                   # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
    ‚îî‚îÄ‚îÄ web/
        ‚îî‚îÄ‚îÄ Dockerfile
    ```

    –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Ñ–∞–π–ª—ã `docker-compose.yml` –∏ `docker-compose.override.yml` –ø–æ–¥—Ö–≤–∞—Ç—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):

    ```bash
    docker compose up -d
    ```

    –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (—è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∞–π–ª—ã):

    ```bash
    docker compose -f docker-compose.yml -f docker-compose.prod.yml up -d
    ```

!!! note "–ü–æ—Ä—è–¥–æ–∫ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è"

    Compose —á–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª—ã –ø–æ –ø–æ—Ä—è–¥–∫—É –∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.

    –ù–∞–ø—Ä–∏–º–µ—Ä, `ports` –∏–∑ `override` –∑–∞–º–µ–Ω—è—Ç `ports` –∏–∑ –±–∞–∑–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞.


### üìÑ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

Docker Compose –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â–µ—Ç —Ñ–∞–π–ª `.env` –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑ –Ω–µ–≥–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

–≠—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–∏ `docker-compose.yml` –¥–ª—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏.

!!! example "–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `.env`"

    `.env`:

    ```env
    TAG=latest
    WEB_PORT=8080
    ```

    **–ü—Ä–∏–º–µ—Ä `docker-compose.yml`:**

    ```yaml
    services:
      web:
        image: myapp:${TAG:-dev} # –ï—Å–ª–∏ TAG –Ω–µ –∑–∞–¥–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 'dev'
        ports:
          - "${WEB_PORT}:80"
    ```

### üìÑ –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∏—Ç–æ–≥–æ–≤—É—é, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

```bash
# –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
docker compose config

# –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
docker compose -f docker-compose.yml -f docker-compose.prod.yml config
```

### üß© –ö–æ–º–ø–æ–∑–∏—Ü–∏—è

–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–µ—Ä–≤–∏—Å–∞ –∏–∑ –¥—Ä—É–≥–æ–≥–æ —Ñ–∞–π–ª–∞.

**–í–Ω–∏–º–∞–Ω–∏–µ:** —ç—Ç–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å—á–∏—Ç–∞–µ—Ç—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–µ–π –≤ –ø–æ–ª—å–∑—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ (`-f` —Ñ–ª–∞–≥).

```yaml
# common.yml
services:
  base: { image: alpine }

# docker-compose.yml
services:
  web:
    extends: { file: common.yml, service: base }
```

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—Ç–∞–¥–∏—é –≤ `Dockerfile` –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –µ–µ —á–µ—Ä–µ–∑ `build.target`.

```dockerfile
# Dockerfile
FROM node:20 AS test
WORKDIR /app
COPY . .
RUN npm ci && npm test
```

```yaml
# docker-compose.test.yml
services:
  sut:
    build: { context: ., target: test }
```

### üß¨ –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ

–ï—Å–ª–∏ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, volume, labels –∏ –¥—Ä.), –≤–º–µ—Å—Ç–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å YAML-–∫–ª—é—á `<<`, —á—Ç–æ–±—ã –≤—Å—Ç—Ä–æ–∏—Ç—å –æ–±—â—É—é —á–∞—Å—Ç—å –∏–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –±–ª–æ–∫–∞ (alias).

!!! example "–ü—Ä–∏–º–µ—Ä –±–∞–∑–æ–≤–æ–≥–æ —à–∞–±–ª–æ–Ω–∞"

    ```yaml
    x-common-env: &common-env
      environment:
        - NODE_ENV=production
        - LOG_LEVEL=info

    x-common-volumes: &common-volumes
      volumes:
        - logs:/var/log/app

    services:
      service-a:
        image: app-a:latest
        <<: [*common-env, *common-volumes]

      service-b:
        image: app-b:latest
        <<: [*common-env, *common-volumes]

    volumes:
      logs:
    ```

!!! tip "–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏"

    –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ `<<`, –≤ —Ç–µ–ª–µ —Å–µ—Ä–≤–∏—Å–∞:

    ```yaml
    services:
      web:
        image: app:latest
        <<: *common-env
        environment:
          - NODE_ENV=development  # –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —è–∫–æ—Ä—è
    ```

!!! warning "–ù–µ –≤—Å–µ YAML-–ø–∞—Ä—Å–µ—Ä—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã"

    –•–æ—Ç—è `<<` ‚Äî —á–∞—Å—Ç—å **YAML-—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏**, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ã –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º–æ–≥—É—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –µ—ë –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

    –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, `docker compose`) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç **merge key** –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ ‚Äî Docker Compose –Ω–∞ –±–∞–∑–µ *Compose Specification* –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç.

---

## ‚ö†Ô∏è –ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏

!!! danger "‚õìÔ∏è `depends_on` ‚Äî –ù–µ –¥–æ–∂–∏–¥–∞–µ—Ç—Å—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞"

    **–ü—Ä–æ–±–ª–µ–º–∞:** `depends_on` —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ **–ø–æ—Ä—è–¥–∫–æ–º –∑–∞–ø—É—Å–∫–∞** –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, –∞ –Ω–µ –∏—Ö –ø–æ–ª–Ω–æ–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å—é –∫ —Ä–∞–±–æ—Ç–µ.

    –í–∞—à —Å–µ—Ä–≤–∏—Å –º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è —Ä–∞–Ω—å—à–µ, —á–µ–º –µ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö) –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.
    
    **–†–µ—à–µ–Ω–∏–µ:**

    1.  **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `healthcheck`:** –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º—ã–π —Å–µ—Ä–≤–∏—Å.
    2.  **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `condition: service_healthy`:** –£–∫–∞–∂–∏—Ç–µ –≤ `depends_on`, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–∂–¥–∞—Ç—å—Å—è —É—Å–ø–µ—à–Ω–æ–≥–æ `healthcheck`.

    ```yaml
    services:
      db:
        image: postgres
        healthcheck:
          test: ["CMD-SHELL", "pg_isready -U postgres"]
          interval: 5s
          timeout: 3s
          retries: 5
      app:
        image: myapp
        depends_on:
          db:
            condition: service_healthy
    ```
    
    –î–ª—è –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –≤ —Å–ª–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ `wait-for-it.sh` –∏–ª–∏ `dockerize`.

!!! danger "configs –∏ secrets ‚Äî –¢–æ–ª—å–∫–æ –¥–ª—è Docker Swarm"

    **–ü—Ä–æ–±–ª–µ–º–∞:** –°–µ–∫—Ü–∏–∏ `configs` –∏ `secrets` –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è —Ä–∞–±–æ—Ç–∞—é—Ç **—Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ Docker Swarm** (`docker stack deploy`), –∞ –Ω–µ —Å `docker compose up`.

    –ò—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –æ—à–∏–±–∫–µ.

    **–†–µ—à–µ–Ω–∏–µ –¥–ª—è `docker compose`:**

    -   **–ö–æ–Ω—Ñ–∏–≥–∏:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `volumes` –¥–ª—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

        ```yaml
        services:
          app:
            volumes:
              - ./myapp.conf:/etc/myapp.conf:ro
        ```

    -   **–°–µ–∫—Ä–µ—Ç—ã:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∑–∞–≥—Ä—É–∂–∞–µ–º—ã–µ –∏–∑ `.env` —Ñ–∞–π–ª–∞.

        ```yaml
        services:
          app:
            environment:
              - DB_PASSWORD=${DB_PASSWORD}
        ```

    **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã!**

    –•—Ä–∞–Ω–∏—Ç–µ –∏—Ö –≤ `.env` —Ñ–∞–π–ª–∞—Ö (–¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –≤ `.gitignore`) –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–∞–º–∏ –≤–∞—à–µ–≥–æ CI/CD.

!!! danger "container_name ‚Äî –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã"

    **–ü—Ä–æ–±–ª–µ–º–∞:** –ñ–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω–æ–µ –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (`container_name`) –º–µ—à–∞–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é (`docker compose up --scale app=3`) –∏ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏–º–µ–Ω, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ CI/CD —Å—Ä–µ–¥–∞—Ö.

    **–†–µ—à–µ–Ω–∏–µ:** –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `container_name`, –µ—Å–ª–∏ –¥–ª—è —ç—Ç–æ–≥–æ –Ω–µ—Ç –≤–µ—Å–∫–æ–π –ø—Ä–∏—á–∏–Ω—ã.

    Docker Compose –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –≤–∏–¥–∞ `<project>_<service>_<index>`, —á—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã.

!!! danger "restart: always ‚Äî –ú–æ–∂–µ—Ç –∑–∞—Ü–∏–∫–ª–∏—Ç—å —Å–±–æ–∏"

    **–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª–∏—Ç–∏–∫–∞ `restart: always` –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω –ø–∞–¥–∞–µ—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞ –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
    –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ "—Å–ø–∞–º—É" –≤ –ª–æ–≥–∞—Ö –∏ –∏–∑–ª–∏—à–Ω–µ–π –Ω–∞–≥—Ä—É–∑–∫–µ –Ω–∞ —Å–∏—Å—Ç–µ–º—É.

    **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `restart: on-failure` (–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–Ω—É–ª–µ–≤–æ–º –∫–æ–¥–µ –≤—ã—Ö–æ–¥–∞) –∏–ª–∏ `restart: unless-stopped` (–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Å–µ–≥–¥–∞, –∫—Ä–æ–º–µ —Å–ª—É—á–∞—è, –∫–æ–≥–¥–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤—Ä—É—á–Ω—É—é).

!!! danger "Docker Compose ‚â† –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä"

    **–ü—Ä–æ–±–ª–µ–º–∞:** Docker Compose ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø—Ä–æ—Å—Ç–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω–∞ –æ–¥–Ω–æ–º —Ö–æ—Å—Ç–µ.

    –û–Ω –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–∞–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π, –∫–∞–∫ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ –º–µ–∂–¥—É —É–∑–ª–∞–º–∏, —Å–∞–º–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (self-healing) –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ.

    **–†–µ—à–µ–Ω–∏–µ:** –î–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä—ã:

    -   **Docker Swarm:** –ü—Ä–æ—Å—Ç–æ–π –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ Docker.
    -   **Kubernetes:** –ò–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `kompose` –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏).
    -   **Nomad, OpenShift, Rancher** –∏ –¥—Ä—É–≥–∏–µ.
