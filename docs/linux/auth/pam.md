---
title: PAM (Pluggable Authentication Modules)
---

# üîå PAM: Pluggable Authentication Modules

**PAM** ‚Äî —ç—Ç–æ –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –º–æ—â–Ω—ã—Ö –∏ –≥–∏–±–∫–∏—Ö, –Ω–æ —á–∞—Å—Ç–æ –Ω–µ–¥–æ–æ—Ü–µ–Ω—ë–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Linux. –≠—Ç–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –Ω–µ –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª–∏—Ä—É—è –∏ –Ω–µ –∏–∑–º–µ–Ω—è—è —Å–∞–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## üéØ –¶–µ–ª—å —Ä–∞–∑–¥–µ–ª–∞

- –ü–æ–Ω—è—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É PAM: –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ñ—Ä–µ–π–º–≤–æ—Ä–∫, –º–æ–¥—É–ª–∏.
- –†–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ —á–µ—Ç—ã—Ä—ë—Ö —Ç–∏–ø–∞—Ö —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (management groups): `auth`, `account`, `password`, `session`.
- –ò–∑—É—á–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ `/etc/pam.d/`.
- –ù–∞—É—á–∏—Ç—å—Å—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å—Ç–µ–∫ –º–æ–¥—É–ª–µ–π –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ª–æ–∂–Ω—ã—Ö –ø–æ–ª–∏—Ç–∏–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ö–æ–¥–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏, —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ —á–ª–µ–Ω—Å—Ç–≤–∞ –≤ –≥—Ä—É–ø–ø–µ).

---

## üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ PAM

PAM —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É "–∂—ë—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–π" –ª–æ–≥–∏–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –∫–∞–∂–¥–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (`login`, `sshd`, `sudo`) —Å–∞–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞–ª–æ –ø—Ä–æ–≤–µ—Ä–∫—É –ø–∞—Ä–æ–ª—è, –æ–Ω–æ –ø—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç PAM API.

**–°—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è:**

```
+-----------+
| –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ|  <-- 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø
| (sshd)    |
+-----------+
      ‚Üì
+------------------------------------+
| –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ PAM (libpam.so)         |  <-- 2. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ–≤–æ—Ä–∏—Ç: "–ü—Ä–æ–≤–µ—Ä—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
+------------------------------------+
      ‚Üì
+------------------------------------+
| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PAM (/etc/pam.d/sshd) |  <-- 3. libpam —á–∏—Ç–∞–µ—Ç –Ω—É–∂–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥
+------------------------------------+
      ‚Üì
+-----------+ +-----------+ +-----------+
| –ú–æ–¥—É–ª—å 1  | | –ú–æ–¥—É–ª—å 2  | | –ú–æ–¥—É–ª—å 3  |  <-- 4. libpam –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç –º–æ–¥—É–ª–∏
| pam_unix.so | pam_access.so | pam_limits.so |
+-----------+ +-----------+ +-----------+
```

- **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Applications):** `login`, `sshd`, `sudo`, `gdm`, `su` –∏ –¥—Ä—É–≥–∏–µ. –û–Ω–∏ "PAM-–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã", —Ç–æ –µ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤—ã–∑–æ–≤—ã PAM API.
- **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ PAM (The PAM library):** `libpam.so`. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥—É–ª–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π.
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:** `/etc/pam.d/`. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî —Å–≤–æ–π —Ñ–∞–π–ª, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–π, –∫–∞–∫–∏–µ –º–æ–¥—É–ª–∏ –∏ –≤ –∫–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –≤—ã–∑—ã–≤–∞—Ç—å.
- **–ú–æ–¥—É–ª–∏ (Modules):** `pam_*.so`, –ª–µ–∂–∞—Ç –≤ `/lib/security/` –∏–ª–∏ `/lib64/security/`. –≠—Ç–æ "—Ä–∞–±–æ—á–∏–µ –ª–æ—à–∞–¥–∫–∏", —Ä–µ–∞–ª–∏–∑—É—é—â–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏: `pam_unix.so` (–ø—Ä–æ–≤–µ—Ä–∫–∞ `/etc/shadow`), `pam_ldap.so` (–ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ LDAP), `pam_access.so` (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —Ñ–∞–π–ª—É –¥–æ—Å—Ç—É–ø–∞), `pam_faillock.so` (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö) –∏ —Ç.–¥.

---

## üß© –ß–µ—Ç—ã—Ä–µ —Å—Ç–æ–ª–ø–∞ PAM: Management Groups

PAM –¥–µ–ª–∏—Ç —Å–ª–æ–∂–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ —á–µ—Ç—ã—Ä–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∞—Å–ø–µ–∫—Ç–∞ (—Å—Ç–µ–∫–∞):

1.  **`auth` (–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è):**
    - **–ó–∞–¥–∞—á–∞:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ç–µ–º, –∑–∞ –∫–æ–≥–æ —Å–µ–±—è –≤—ã–¥–∞—ë—Ç. –û–±—ã—á–Ω–æ —ç—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏ –±–∏–æ–º–µ—Ç—Ä–∏—è, –∏ 2FA.
    - **–ü—Ä–∏–º–µ—Ä –º–æ–¥—É–ª—è:** `pam_unix.so` (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–∞—Ä–æ–ª—å), `pam_google_authenticator.so` (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç OTP).

2.  **`account` (–£—á—ë—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å):**
    - **–ó–∞–¥–∞—á–∞:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Ä–∞–∑—Ä–µ—à—ë–Ω –ª–∏ –¥–æ—Å—Ç—É–ø —ç—Ç–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é **—Å–µ–π—á–∞—Å**. –≠—Ç–æ –Ω–µ –ø—Ä–æ –ø–∞—Ä–æ–ª—å, –∞ –ø—Ä–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏.
    - **–ü—Ä–∏–º–µ—Ä—ã:** –ù–µ –∏—Å—Ç—ë–∫ –ª–∏ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª—è? –ù–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –ª–∏ —É—á—ë—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å? –†–∞–∑—Ä–µ—à—ë–Ω –ª–∏ –≤—Ö–æ–¥ –≤ —ç—Ç–æ –≤—Ä–µ–º—è —Å—É—Ç–æ–∫? –Ø–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–ª–µ–Ω–æ–º –Ω—É–∂–Ω–æ–π –≥—Ä—É–ø–ø—ã?
    - **–ü—Ä–∏–º–µ—Ä –º–æ–¥—É–ª—è:** `pam_access.so` (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –≤ `access.conf`), `pam_time.so` (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ –≤—Ä–µ–º–µ–Ω–∏).

3.  **`password` (–ü–∞—Ä–æ–ª—å):**
    - **–ó–∞–¥–∞—á–∞:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è–º–∏. –≠—Ç–æ—Ç —Å—Ç–µ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ –ø–∞—Ä–æ–ª—è.
    - **–ü—Ä–∏–º–µ—Ä—ã:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏.
    - **–ü—Ä–∏–º–µ—Ä –º–æ–¥—É–ª—è:** `pam_pwquality.so` (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å), `pam_unix.so` (–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–π —Ö—ç—à –≤ `/etc/shadow`).

4.  **`session` (–°–µ—Å—Å–∏—è):**
    - **–ó–∞–¥–∞—á–∞:** –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –¥–æ –∏ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏.
    - **–ü—Ä–∏–º–µ—Ä—ã:** –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–º–∞—à–Ω–µ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞, –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–∏–º–∏—Ç–æ–≤ (`ulimit`), –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞.
    - **–ü—Ä–∏–º–µ—Ä –º–æ–¥—É–ª—è:** `pam_mkhomedir.so` (—Å–æ–∑–¥–∞—ë—Ç home dir), `pam_limits.so` (–ø—Ä–∏–º–µ–Ω—è–µ—Ç –ª–∏–º–∏—Ç—ã –∏–∑ `limits.conf`).

---

## üìú –°–∏–Ω—Ç–∞–∫—Å–∏—Å `/etc/pam.d/`

–ö–∞–∂–¥—ã–π —Ñ–∞–π–ª –≤ `/etc/pam.d/` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/etc/pam.d/sshd`) —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å—Ç—Ä–æ–∫ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞:

`<type> <control> <module-path> [module-arguments]`

**–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–æ–∫–∏:**
`auth      required  pam_unix.so   nullok_secure`

- **`type`:** –¢–∏–ø —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (`auth`, `account`, `password`, `session`).
- **`control`:** **–£–ø—Ä–∞–≤–ª—è—é—â–∏–π —Ñ–ª–∞–≥.** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è –≤–ª–∏—è–µ—Ç –Ω–∞ –æ–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ç–µ–∫–∞. –≠—Ç–æ —Å–∞–º–∞—è –≤–∞–∂–Ω–∞—è —á–∞—Å—Ç—å!
- **`module-path`:** –ò–º—è –º–æ–¥—É–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `pam_unix.so`).
- **`module-arguments`:** –ê—Ä–≥—É–º–µ–Ω—Ç—ã, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–µ –º–æ–¥—É–ª—é.

### –£–ø—Ä–∞–≤–ª—è—é—â–∏–µ —Ñ–ª–∞–≥–∏ (Control Flags)

| –§–ª–∞–≥ | –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –£–°–ü–ï–•–ï | –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –ù–ï–£–î–ê–ß–ï |
| :--- | :--- | :--- |
| **`required`** | –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç–µ–∫–∞. | **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ —Å–æ–æ–±—â–∞–µ–º –æ –Ω–µ—É–¥–∞—á–µ**, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç–µ–∫–∞ (—á—Ç–æ–±—ã –Ω–µ –¥–∞—Ç—å –∞—Ç–∞–∫—É—é—â–µ–º—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω–∞ –∫–∞–∫–æ–º –∏–º–µ–Ω–Ω–æ –º–æ–¥—É–ª–µ –ø—Ä–æ–∏–∑–æ—à—ë–ª —Å–±–æ–π). **–ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç "–Ω–µ—É–¥–∞—á–∞".** |
| **`requisite`** | –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç–µ–∫–∞. | **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç–µ–∫–∞** –∏ —Å–æ–æ–±—â–∞–µ–º –æ –Ω–µ—É–¥–∞—á–µ. –ë—ã—Å—Ç—Ä–µ–µ, –Ω–æ –º–æ–∂–µ—Ç —Ä–∞—Å–∫—Ä—ã—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. |
| **`sufficient`** | **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç–µ–∫–∞** –∏ —Å–æ–æ–±—â–∞–µ–º –æ–± —É—Å–ø–µ—Ö–µ (–µ—Å–ª–∏ –¥–æ —ç—Ç–æ–≥–æ –Ω–µ –±—ã–ª–æ `required` —Å–±–æ–µ–≤). | –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –Ω–µ—É–¥–∞—á—É –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç–µ–∫–∞. |
| **`optional`** | –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç–µ–∫–∞. | –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –Ω–µ—É–¥–∞—á—É –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç–µ–∫–∞. –ú–æ–¥—É–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤ —Å—Ç–µ–∫–µ. |
| **`include`** | –í–∫–ª—é—á–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏ –∏–∑ –¥—Ä—É–≥–æ–≥–æ PAM-—Ñ–∞–π–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `system-auth`). | |
| **`substack`** | –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ `include`, –Ω–æ —Å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–æ–π –≤–æ–∑–≤—Ä–∞—Ç–∞ —É—Å–ø–µ—Ö–∞/–Ω–µ—É–¥–∞—á–∏. | |

**–ü—Ä–∏–º–µ—Ä —Å—Ç–µ–∫–∞ `auth` –¥–ª—è `sshd`:**

```
#%PAM-1.0
auth       required     pam_faillock.so preauth silent audit deny=3 unlock_time=900
auth       sufficient   pam_unix.so     try_first_pass
auth       [default=die] pam_faillock.so authfail audit deny=3 unlock_time=900
auth       required     pam_deny.so
```

**–†–∞–∑–±–æ—Ä:**
1.  `pam_faillock.so preauth`: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –ï—Å–ª–∏ –¥–∞, `required` –∑–∞–ø–æ–º–Ω–∏—Ç —ç—Ç–æ. `silent` ‚Äî –Ω–µ —Å–æ–æ–±—â–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ.
2.  `pam_unix.so`: –ü—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª—å. –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ, `sufficient` –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Å—Ç–µ–∫ —Å —É—Å–ø–µ—Ö–æ–º (–µ—Å–ª–∏ `faillock` –Ω–µ –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è).
3.  `pam_faillock.so authfail`: –≠—Ç–æ—Ç –º–æ–¥—É–ª—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `pam_unix` –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è. –û–Ω —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫.
4.  `pam_deny.so`: –ï—Å–ª–∏ –º—ã –¥–æ—à–ª–∏ –¥–æ—Å—é–¥–∞ (—Ç.–µ. `pam_unix` –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è), —ç—Ç–æ—Ç –º–æ–¥—É–ª—å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ—É–¥–∞—á—É.

---

## üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è SSH

**–ó–∞–¥–∞—á–∞:** –†–∞–∑—Ä–µ—à–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é `developer` –≤—Ö–æ–¥–∏—Ç—å –ø–æ SSH —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è (–ü–Ω-–ü—Ç, 9:00-18:00).

1.  **–†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º `/etc/security/time.conf`:**
    ```
    sshd;*;developer;!Wd0900-1800
    ```
    - `sshd`: –°–µ—Ä–≤–∏—Å.
    - `*`: –¢–µ—Ä–º–∏–Ω–∞–ª (–ª—é–±–æ–π).
    - `developer`: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.
    - `!Wd0900-1800`: –ó–∞–ø—Ä–µ—Ç–∏—Ç—å (`!`) –≤ —Ä–∞–±–æ—á–∏–µ –¥–Ω–∏ (`Wd`) —Å 9 –¥–æ 18. –õ–æ–≥–∏–∫–∞ –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞: –º—ã —É–∫–∞–∑—ã–≤–∞–µ–º, –∫–æ–≥–¥–∞ –¥–æ—Å—Ç—É–ø **–∑–∞–ø—Ä–µ—â—ë–Ω**.

2.  **–î–æ–±–∞–≤–ª—è–µ–º `pam_time.so` –≤ `/etc/pam.d/sshd`:**
    ```
    # /etc/pam.d/sshd
    ...
    account    required     pam_nologin.so
    account    required     pam_time.so   # <--- –î–û–ë–ê–í–ò–¢–¨ –≠–¢–£ –°–¢–†–û–ö–£
    ...
    ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ —á–ª–µ–Ω—Å—Ç–≤–∞ –≤ –≥—Ä—É–ø–ø–µ –¥–ª—è `sudo`

**–ó–∞–¥–∞—á–∞:** –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—ã–ø–æ–ª–Ω—è—Ç—å `sudo` —Ç–æ–ª—å–∫–æ —á–ª–µ–Ω–∞–º –≥—Ä—É–ø–ø—ã `wheel`.

1.  **–†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º `/etc/pam.d/sudo`:**
    ```
    #%PAM-1.0
    auth       include      system-auth
    auth       required     pam_wheel.so use_uid # <--- –î–û–ë–ê–í–ò–¢–¨ –≠–¢–£ –°–¢–†–û–ö–£
    account    include      system-auth
    password   include      system-auth
    session    include      system-auth
    ```
    - `pam_wheel.so`: –ú–æ–¥—É–ª—å, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —á–ª–µ–Ω—Å—Ç–≤–æ –≤ –≥—Ä—É–ø–ø–µ `wheel` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).
    - `use_uid`: –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π **–≤—ã–ø–æ–ª–Ω—è–µ—Ç** `sudo`, –∞ –Ω–µ —Ç–æ–≥–æ, –ø–æ–¥ –∫–æ—Ç–æ—Ä—ã–º –∫–æ–º–∞–Ω–¥–∞ –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω–∞.

–≠—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –≤–æ –º–Ω–æ–≥–∏—Ö –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞—Ö (RHEL, Fedora).
